<? $partViewer->view('parts/header'); ?>

<!-- Begin page content -->
<main role="main" class="container flex-shrink-0">
    
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="<?=CommonUtils::makeUrl('main')?>">Админ</a></li>
            <li class="breadcrumb-item active" aria-current="page">Запросы кредитов</li>
        </ol>
    </nav>
    
    <? if ($list) { ?>
    <div class="table-responsive">
        <table class="table table-hover table-striped">
        <thead>
            <tr>
                <th scope="col">Пользователь</th>
                <th scope="col">Статус</th>
                <th scope="col">Сумма</th>
                <th scope="col">&nbsp;</th>
            </tr>
        </thead>
        <tbody>
        <? foreach($list as $item) { ?>
        <tr>
            <td class="align-middle"><?=$item->isDeleted()?'<del>':''?><?=$item->getUser()->getName()? htmlspecialchars($item->getUser()->getName()) : htmlspecialchars($item->getUser()->getEmail())?><?=$item->isDeleted()?'</del>':''?></td>
            <td class="align-middle">
                <span class="text-<?=$item->getStatus()->getId()==CreditRequestStatus::TYPE_INCOME?'danger':($item->getStatus()->getId()==CreditRequestStatus::TYPE_CONCIDERED?'warning': (in_array($item->getStatus()->getId(), array(CreditRequestStatus::TYPE_APPROVE, CreditRequestStatus::TYPE_CONFIRM, CreditRequestStatus::TYPE_SUCCESS))?'success': ($item->getStatus()->getId()==CreditRequestStatus::TYPE_REJECT?'secondary' : 'dark') ) )?>"><?=$item->getStatus()->getName()?></span>
            </td>
            <td class="align-middle"><?=$item->isDeleted()?'<del>':''?><a href="<?=CommonUtils::makeUrl('creditRequestEditor', array('action' => creditRequestEditor::ACTION_VIEW, 'id' => $item->getId(), 'return' => $curl))?>"><?=htmlspecialchars($item->getName())?> / <?=htmlspecialchars($item->getCategory()->getName())?> / <?=number_format($item->getSumm(), 0, '.', '&nbsp;').'&#8381;'?></a><?=$item->isDeleted()?'</del>':''?></td>
            <td class="align-middle">
                <? if ($item->checkPermissions(AclAction::RESTORE_ACTION)) { ?><a href="<?=CommonUtils::makeUrl('creditRequestEditor', array('action' => CommandContainer::ACTION_RESTORE, 'id' => $item->getId(), 'return' => $curl))?>"><i class="fas fa-undo-alt"></i></a><? } ?>
            </td>
        </tr>
        <? } ?>
        </tbody>
        </table>
    </div>
    <? } else { ?>
        <div class="card">
          <div class="card-body">
            <p class="my-4 text-center">еще ничего не добавлено&hellip;</p>
          </div>
        </div>    
    <? } ?>
    
</main>  

<? $partViewer->view('parts/footer'); ?>